set -ex

export ETH_GAS=${ETH_GAS:-4712388}
export ETH_KEYSTORE=${ETH_KEYSTORE:-./keystore}
export ETH_RPC_URL=${ETH_RPC_URL:-"https://kovan.infura.io/v3/3a3b70c2e1704daa8218f1ef901a2720"}
export ETH_PASSWORD=${ETH_PASSWORD:-"/dev/null"}
export ETH_FROM=${ETH_FROM:-"0x89b0a86583c4444acfd71b463e0d3c55ae1412a5"}

ORACLE_PAYMENT=${ORACLE_PAYMENT:-1}
LINK_CONTRACT=${LINK_CONTRACT:-"0xa36085F69e2889c224210F603D836748e7dC0088"}
ORACLE_CONTRACT=${ORACLE_CONTRACT:-"0x2f90A6D021db21e1B2A077c5a37B3C7E75D15b7e"}
JOB_ID=${JOB_ID:-"0x000000000000000000000000000000005a6f668df54545ee842e111a13c36d6b"}

dapp update
dapp --use solc:0.5.0 build --extract
ORACLE=$(seth send --create out/Oracle.bin 'Oracle(address, address, bytes32, uint256)' $LINK_CONTRACT $ORACLE_CONTRACT $JOB_ID $ORACLE_PAYMENT)

set +ex
echo "-------------------------------------------------------------------------------"
echo "Oracle deployed to: $ORACLE"
echo "-------------------------------------------------------------------------------"
